<main class="dashboard-main">
    <div class="container py-4">
        <header class="dashboard-header mb-5">
            <h1 id="welcomeMessage">Good {{timeOfDay}}, <span id="userGreeting">{{user.firstName}}</span></h1>
            <p class="text-muted">Your Wardrobe Overview</p>
            
            {{#if trialRemaining}}
            <div class="alert alert-info mt-3">
                <i class="bi bi-info-circle"></i>
                <strong>Trial Account:</strong> 
                {{#if trialRemaining.itemsLeft}}
                    {{trialRemaining.itemsLeft}} items left to upload
                {{/if}}
                {{#if trialRemaining.outfitsLeft}}
                    • {{trialRemaining.outfitsLeft}} outfit{{#if (gt trialRemaining.outfitsLeft 1)}}s{{/if}} left to generate
                {{/if}}
                {{#if trialRemaining.expiresAt}}
                    • Expires {{formatDate trialRemaining.expiresAt}}
                {{/if}}
            </div>
            {{/if}}
        </header>
        
        <div class="row g-4 mb-5">
            <div class="col-lg-7">
                <div class="dashboard-card">
                    <div class="dashboard-card-header">
                        <h2>Today's Outfit</h2>
                        {{#if weather}}
                        <div class="weather-badge">
                            <i class="bi bi-{{weather.icon}}"></i>
                            <span>{{weather.temperature}}°C</span>
                        </div>
                        {{/if}}
                    </div>
                    <div class="dashboard-card-body">
                        {{#if todaysOutfit}}
                        <div class="outfit-display">
                            <div class="outfit-image">
                                <img src="{{todaysOutfit.image}}" alt="Today's outfit" class="img-fluid rounded">
                            </div>
                            <div class="outfit-details">
                                <h3>{{todaysOutfit.title}}</h3>
                                <ul class="outfit-items">
                                    {{#each todaysOutfit.items}}
                                    <li>{{this.name}}</li>
                                    {{/each}}
                                </ul>
                                <button class="btn btn-primary mt-3" onclick="router.navigate('outfit', { id: todaysOutfit.id })">View Details</button>
                            </div>
                        </div>
                        {{else}}
                        <div class="text-center py-4">
                            <i class="bi bi-calendar-x fs-1 text-muted mb-3"></i>
                            <h4>No outfit scheduled</h4>
                            <p class="text-muted">Create a schedule to get outfit recommendations</p>
                            <button class="btn btn-primary" onclick="router.navigate('schedule')">Create Schedule</button>
                        </div>
                        {{/if}}
                    </div>
                </div>
            </div>
            
            <div class="col-lg-5">
                <div class="dashboard-card">
                    <div class="dashboard-card-header">
                        <h2>Wardrobe Stats</h2>
                    </div>
                    <div class="dashboard-card-body">
                        <div class="stats-container">
                            <div class="stat-item">
                                <div class="stat-value">{{stats.totalItems}}</div>
                                <div class="stat-label">Total Items</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">{{stats.totalOutfits}}</div>
                                <div class="stat-label">Outfits</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">{{stats.favoriteItems}}</div>
                                <div class="stat-label">Favorites</div>
                            </div>
                        </div>
                        
                        {{#if stats.mostWorn}}
                        <div class="most-worn mt-4">
                            <h3>Most Worn</h3>
                            <div class="most-worn-item">
                                <img src="{{stats.mostWorn.image}}" alt="Most Worn Item" class="rounded">
                                <div>
                                    <h4>{{stats.mostWorn.name}}</h4>
                                    <p>Worn {{stats.mostWorn.count}} times</p>
                                </div>
                            </div>
                        </div>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h2>Recent Activity</h2>
                <a href="#" class="view-all" onclick="router.navigate('activity')">View All</a>
            </div>
            <div class="dashboard-card-body p-0">
                {{#if activities}}
                <ul class="activity-list">
                    {{#each activities}}
                    <li class="activity-item">
                        <div class="activity-icon">
                            <i class="bi bi-{{this.icon}}"></i>
                        </div>
                        <div class="activity-content">
                            <p>{{{this.content}}}</p>
                            <span class="activity-time">{{this.time}}</span>
                        </div>
                    </li>
                    {{/each}}
                </ul>
                {{else}}
                <div class="text-center py-4">
                    <i class="bi bi-activity fs-1 text-muted mb-3"></i>
                    <h4>No recent activity</h4>
                    <p class="text-muted">Start by adding items to your wardrobe</p>
                </div>
                {{/if}}
            </div>
        </div>
    </div>
</main>